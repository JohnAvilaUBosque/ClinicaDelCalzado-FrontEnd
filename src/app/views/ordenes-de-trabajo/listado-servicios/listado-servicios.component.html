<c-row>
    <c-col>
        <form cForm #serviciosForm="ngForm">
            <table cTable hover bordered>
                <thead>
                    <tr>
                        <th scope="col" class="col-7">Listado de servicios</th>
                        <th scope="col" class="col-4">Precio individual</th>
                        @if (esSoloLectura) {
                        <th scope="col" class="col">Estado</th>
                        }
                        @else {
                        <th scope="col" class="col"></th>
                        }
                    </tr>
                </thead>
                <tbody>

                    @for (service of servicios; track $index) {
                    <tr>
                        <td>
                            <textarea #textareaElement (input)="adjustTextareaHeight(textareaElement)" cFormControl
                                rows="1" [(ngModel)]="service.descripcion" name="nameService{{$index}}"
                                #nameService="ngModel" maxlength="100" required
                                [valid]="nameService.touched && nameService.invalid ? false : undefined"
                                [readonly]="esSoloLectura" [plaintext]="esSoloLectura"
                                style="resize: none; overflow: hidden;"></textarea>
                            <c-form-feedback *ngIf="!!(nameService.touched && nameService.invalid)" [valid]="false">
                                Este campo es requerido!
                            </c-form-feedback>
                        </td>
                        <td>
                            <input cFormControl type="text"
                                [ngModel]="service.precio | currency: 'COP' : 'symbol-narrow' : '1.0'"
                                (ngModelChange)="cambiarPrecioIndividual($event, $index)" name="price{{$index}}"
                                #price="ngModel" maxlength="11" required [pattern]="constService.REGULAR_EXP.CURRENCY"
                                [valid]="price.touched && price.invalid ? false : undefined" [readonly]="esSoloLectura"
                                [plaintext]="esSoloLectura">
                            <c-form-feedback *ngIf="!!(price.touched && price.invalid)" [valid]="false">
                                Este campo es requerido y debe ser un valor monetario v√°lido!
                            </c-form-feedback>
                        </td>
                        @if (esSoloLectura) {
                        <td>
                            <c-badge
                                color="{{service.estado == constService.ESTADO_SERVICIO.RECIBIDO ? 'warning' : service.estado == constService.ESTADO_SERVICIO.TERMINADO ?  'info' : 'success'}}"
                                shape="rounded-pill" class="mt-2">
                                {{service.estado | uppercase}}
                            </c-badge>
                        </td>
                        }
                        @else {
                        <td>
                            <button cButton color="danger" variant="outline" size="sm" shape="rounded-pill"
                                cTooltip="Borrar servicio" (click)="borrarServicio($index)">
                                <svg cIcon name="cil-x"></svg>
                            </button>
                        </td>
                        }
                    </tr>
                    }
                </tbody>
            </table>
        </form>
    </c-col>
</c-row>

@if (!esSoloLectura) {
<c-row>
    <c-col xs="auto">
        <button cButton color="primary" variant="outline" size="sm" shape="rounded-pill" cTooltip="Agregar servicio"
            (click)="agregarServicioAOrden()">
            <svg cIcon name="cil-plus"></svg>
        </button>
    </c-col>
</c-row>
}